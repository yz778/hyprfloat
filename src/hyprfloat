#!/usr/bin/env lua

local function get_real_script_dir()
    local script_path = debug.getinfo(1, "S").source:sub(2)
    local handle = io.popen("readlink -f " .. script_path)
    local real_path = handle:read("*a"):gsub("\n$", "")
    handle:close()
    return real_path:match("^(.+)/[^/]*$") .. "/"
end

local script_dir = get_real_script_dir()
package.path = script_dir .. "?.lua;" .. script_dir .. "?/init.lua;" .. package.path

-- Load and run the main library
local lib = require("lib")
lib.run(arg)
